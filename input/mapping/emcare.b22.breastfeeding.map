map 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureMap/emcare.b22.breastfeeding' = 'emcare.b22.breastfeeding'
uses 'http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaireresponse' alias 'questionnaireResponse' as source
uses 'http://hl7.org/fhir/StructureDefinition/Bundle' alias 'Bundle' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/observation' alias 'Observation' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation' alias 'EmCare Observation' as produced
group bundletrans(source src : questionnaireResponse,target bundle : Bundle){
    src -> bundle.id = uuid() 'id';
    src -> bundle.type = 'batch' 'type';
    src.item first as item  where linkId = 'EmCare.B24.G.DE28' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde28(src, tgt) '098b1c6e';
            } '170a06a4';
        } 'ad01bdfb';
    } 'fd0b085e';
    src.item first as item  where linkId = 'EmCare.B24.G.DE34' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde34(src, tgt) 'e3fb37a8';
            } '78b1d1f7';
        } 'ae510f78';
    } 'da230e09';
    src.item first as item  where linkId = 'EmCare.B24.G.DE35' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde35(src, tgt) '857bf766';
            } 'a454798b';
        } 'edf0cf6e';
    } 'a4504899';
    src.item first as item  where linkId = 'EmCare.B24.G.DE37' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde37(src, tgt) '7583c0c9';
            } '211d7976';
        } 'c40311ab';
    } 'b6516953';
    src.item first as item  where linkId = 'EmCare.B24.G.DE38' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde38(src, tgt) '854df315';
            } '38d49fa3';
        } 'aa632e75';
    } '3696f6b2';
}

group emcareobservationemcareb24gde28(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde28';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE28'
         'code-emcareb24gde28';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE28' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde28';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde28';
        } 'bdab9370';
    } 'bcffb048';
}

group emcareobservationemcareb24gde34(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde34';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE34'
         'code-emcareb24gde34';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE34' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde34';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde34';
        } 'bdab9370';
    } '1a12b4fc';
}

group emcareobservationemcareb24gde35(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde35';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE35'
         'code-emcareb24gde35';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE35' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde35';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde35';
        } 'bdab9370';
    } 'ca1402b5';
}

group emcareobservationemcareb24gde37(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde37';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE37'
         'code-emcareb24gde37';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE37' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde37';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde37';
        } 'bdab9370';
    } '21300db2';
}

group emcareobservationemcareb24gde38(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde38';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE38'
         'code-emcareb24gde38';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE38' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde38';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde38';
        } 'bdab9370';
    } 'ac90f315';
}

