map 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureMap/emcare.b22.secondtemperature' = 'emcare.b22.secondtemperature'
uses 'http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaireresponse' alias 'questionnaireResponse' as source
uses 'http://hl7.org/fhir/StructureDefinition/Bundle' alias 'Bundle' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/observation' alias 'Observation' as target
uses 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation' alias 'EmCare Observation' as produced
group bundletrans(source src : questionnaireResponse,target bundle : Bundle){
    src -> bundle.id = uuid() 'id';
    src -> bundle.type = 'batch' 'type';
    src.item first as item  where linkId = 'EmCare.B22.DE47' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb22de47(src, tgt) '27e1ae58';
            } '68ad31bf';
        } '6ac0c1c9';
    } '921b6c4e';
    src.item first as item  where linkId = 'EmCare.B24.G.DE40' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde40(src, tgt) '1ed7d698';
            } '46389559';
        } '5ae47295';
    } '35e3fc8b';
    src.item first as item  where linkId = 'EmCare.B24.G.DE41' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb24gde41(src, tgt) '2bc5268a';
            } '80311ee6';
        } '301d5833';
    } 'ae67d33f';
    src.item first as item  where linkId = 'EmCare.B22.DE46' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb22de46(src, tgt) 'd4ea6333';
            } '1ee0adeb';
        } '9266b262';
    } '822ffc0d';
    src.item first as item  where linkId = 'EmCare.B22.DE50' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb22de50(src, tgt) 'b5c48578';
            } '1d3deeec';
        } '82120e52';
    } '7a077eb8';
    src.item first as item  where linkId = 'EmCare.B22.DE52A' and answer.exists() then {
        src -> bundle.entry as entry  then {
            src -> entry.request as request, request.method = 'POST' , uuid() as uuid, request.url = append('/Observation/', uuid) 'b50ac4c5';
            src -> entry.resource = create('Observation') as tgt then {
                src -> tgt then emcareobservationemcareb22de52a(src, tgt) 'f3d91e56';
            } 'bd967914';
        } 'f96001c2';
    } '4b7b2d1d';
}

group emcareobservationemcareb22de47(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb22de47';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B22.DE47'
         'code-emcareb22de47';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B22.DE47' and answer.exists() then {
        item.answer first as a then {
            a.value as val -> tgt.value = val, tgt.status = 'final' 'afa0ccc0';
        } 'd40466ff';
    } '48393240';
}

group emcareobservationemcareb24gde40(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde40';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE40'
         'code-emcareb24gde40';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE40' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb24gde40';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb24gde40';
        } 'bdab9370';
    } '7177ad06';
}

group emcareobservationemcareb24gde41(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb24gde41';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B24.G.DE41'
         'code-emcareb24gde41';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B24.G.DE41' and answer.exists() then {
        item.answer first as a then {
            a.value as val -> tgt.value = val, tgt.status = 'final' 'afa0ccc0';
        } 'd40466ff';
    } 'eebcd9e3';
}

group emcareobservationemcareb22de46(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb22de46';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B22.DE46'
         'code-emcareb22de46';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B22.DE46' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb22de46';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb22de46';
        } 'bdab9370';
    } 'c1c0adb4';
}

group emcareobservationemcareb22de50(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb22de50';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B22.DE50'
         'code-emcareb22de50';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B22.DE50' and answer.exists() then {
        item.answer first as a then {
            a.value as val then {
                val -> tgt.value = create('CodeableConcept') as cc, cc.coding = create('Coding') as c, c.code=val, c.system= 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes', tgt.status = 'final' '759a9a54';
            } '1b820ab0';
        } 'd39f9088';
    } '7972a70f';
}

group emcareobservationemcareb22de52a(source src,target tgt){
        src -> tgt.identifier = create('Identifier') as CodeID,
            CodeID.system = 'http://hl7.org/fhir/namingsystem-identifier-type',
            CodeID.use =  'official',
            CodeID.value = 'uuid',
            CodeID.id = uuid()
         'id-emcareb22de52a';
    src.encounter as encounter -> tgt.encounter = encounter '35bc6b82';
        src.subject as subject -> tgt.subject = subject,
            tgt.meta = create('Meta') as newMeta, newMeta.profile = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/StructureDefinition/emcareobservation',
            tgt.code = create('CodeableConcept') as concept, concept.coding = create('Coding') as coding,
                coding.system = 'https://fhir.dk.swisstph-mis.ch/matchbox/fhir/CodeSystem/emcare-custom-codes',
                coding.code = 'EmCare.B22.DE52A'
         'code-emcareb22de52a';
    src.item as itemtimestamp where linkId  =  'timestamp' then {
        itemtimestamp.answer first as atimestamp then {
            atimestamp.value as val -> tgt.issued = val  '5af77f2c';
        } '7f22f29f';
    } 'aae7a11d';
    src.subject as subject -> tgt.subject = subject  'patient';
    src.item first as item  where linkId = 'EmCare.B22.DE52A' and answer.exists() then {
        item.answer first as a then {
            a  where a.value = true -> tgt.status = 'final', tgt.value = true 'final-emcareb22de52a';
            a  where a.value = false -> tgt.status = 'cancelled', tgt.value = false 'notfound-emcareb22de52a';
        } 'bdab9370';
    } '7ec5e868';
}

